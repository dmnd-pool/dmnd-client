(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[463],{333:(e,t,a)=>{"use strict";a.d(t,{d:()=>o});var n=a(5155),l=a(2115),i=a(4884),s=a(9434);let o=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(i.bL,{className:(0,s.cn)("peer focus-visible:ring-ring focus-visible:ring-offset-background data-[state=checked]:bg-primary data-[state=unchecked]:bg-input inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",a),...l,ref:t,children:(0,n.jsx)(i.zi,{className:(0,s.cn)("bg-background pointer-events-none block h-5 w-5 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=i.bL.displayName},408:(e,t,a)=>{"use strict";a.d(t,{SettingsProvider:()=>r,dq:()=>u,sA:()=>d,t0:()=>c});var n=a(5155),l=a(2115);let i="jd-tx-selection-settings",s={autoSelection:{onNewTemplate:{enabled:!1,selectionStrategy:"maximizeFees",minFeeRate:1,maxSize:1e5,minBaseFee:1e3,maxAncestorCount:25,maxDescendantCount:25,excludeBip125Replaceable:!1,excludeUnbroadcast:!1,maxTransactionCount:5e3,requireTemplate:!0,clearExistingSelections:!1,periodicEnabled:!1,periodicInterval:30,autoJobDeclaration:!1}},general:{autoScrollToTable:!0,showNotifications:!0,pauseOnSelection:!1,clearSelectionOnJobDeclaration:!0,preserveExistingSelections:!0,autoCleanInvalidTransactions:!0}},o=(0,l.createContext)(void 0);function r(e){let{children:t}=e,[a,r]=(0,l.useState)(s),[c,d]=(0,l.useState)(!0);(0,l.useEffect)(()=>{try{let t=localStorage.getItem(i);if(t){var e;let a=JSON.parse(t);r({...s,...a,autoSelection:{...s.autoSelection,...a.autoSelection,onNewTemplate:{...s.autoSelection.onNewTemplate,...null==(e=a.autoSelection)?void 0:e.onNewTemplate}},general:{...s.general,...a.general}})}}catch(e){console.error("Failed to load settings from localStorage:",e),r(s)}finally{d(!1)}},[]),(0,l.useEffect)(()=>{if(!c)try{localStorage.setItem(i,JSON.stringify(a))}catch(e){console.error("Failed to save settings to localStorage:",e)}},[a,c]);let u=(0,l.useCallback)(e=>{r(t=>{var a;return{...t,...e,autoSelection:{...t.autoSelection,...e.autoSelection,onNewTemplate:{...t.autoSelection.onNewTemplate,...null==(a=e.autoSelection)?void 0:a.onNewTemplate}},general:{...t.general,...e.general}}})},[]),m=(0,l.useCallback)(()=>{r(s);try{localStorage.removeItem(i)}catch(e){console.error("Failed to remove settings from localStorage:",e)}},[]);return(0,n.jsx)(o.Provider,{value:{settings:a,updateSettings:u,resetSettings:m,isLoading:c},children:t})}function c(){let e=(0,l.useContext)(o);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}function d(){let{settings:e,updateSettings:t}=c();return{autoSelection:e.autoSelection,updateAutoSelection:a=>t({autoSelection:{...e.autoSelection,...a}})}}function u(){let{settings:e,updateSettings:t}=c();return{general:e.general,updateGeneral:a=>t({general:{...e.general,...a}})}}},4944:(e,t,a)=>{"use strict";a.d(t,{k:()=>s});var n=a(5155);a(2115);var l=a(5863),i=a(9434);function s(e){let{className:t,value:a,...s}=e;return(0,n.jsx)(l.bL,{"data-slot":"progress",className:(0,i.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...s,children:(0,n.jsx)(l.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}},5127:(e,t,a)=>{"use strict";a.d(t,{Table:()=>i,TableBody:()=>o,TableCell:()=>d,TableHead:()=>c,TableHeader:()=>s,TableRow:()=>r});var n=a(5155);a(2115);var l=a(9434);function i(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,n.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",t),...a})})}function s(e){let{className:t,...a}=e;return(0,n.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",t),...a})}function o(e){let{className:t,...a}=e;return(0,n.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",t),...a})}function r(e){let{className:t,...a}=e;return(0,n.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function c(e){let{className:t,...a}=e;return(0,n.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function d(e){let{className:t,...a}=e;return(0,n.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},6102:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>s,ZI:()=>c,k$:()=>r,m_:()=>o});var n=a(5155);a(2115);var l=a(9613),i=a(9434);function s(e){let{delayDuration:t=0,...a}=e;return(0,n.jsx)(l.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function o(e){let{...t}=e;return(0,n.jsx)(s,{children:(0,n.jsx)(l.bL,{"data-slot":"tooltip",...t})})}function r(e){let{...t}=e;return(0,n.jsx)(l.l9,{"data-slot":"tooltip-trigger",...t})}function c(e){let{className:t,sideOffset:a=0,children:s,...o}=e;return(0,n.jsx)(l.ZL,{children:(0,n.jsxs)(l.UC,{"data-slot":"tooltip-content",sideOffset:a,className:(0,i.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...o,children:[s,(0,n.jsx)(l.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},6550:(e,t,a)=>{Promise.resolve().then(a.bind(a,9438))},6844:(e,t,a)=>{"use strict";a.d(t,{Ou:()=>u,X1:()=>r,g0:()=>d});var n=a(5155),l=a(2115),i=a(1320),s=a(6671);let o=(0,l.createContext)(void 0);function r(e){let{children:t,wsUrl:a="ws://localhost:3001/ws/jd/stream"}=e,[r,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(null),[m,x]=(0,l.useState)(!1),h=(0,l.useRef)(null),g=(0,l.useCallback)(e=>{c(t=>[e,...t].slice(0,100))},[]);(0,l.useEffect)(()=>{let e=new i.A(a);return h.current=e,e.onopen=()=>{g({event:"WebSocketOpen",timestamp:new Date().toLocaleString(),level:"INFO",message:"Connected to job declaration stream"})},e.onmessage=e=>{try{let t=JSON.parse(e.data),a={event:t.event,timestamp:new Date(1e3*t.timestamp).toLocaleString(),level:"INFO",message:t.message};g(a),"NewTemplate"===t.event?u(t.template_id):u(null),s.oR.info(t.event,{description:t.message,action:"NewTemplate"===t.event?{label:"Select Transactions",onClick:()=>{let e=document.querySelector(".data-table-container");e&&e.scrollIntoView({behavior:"smooth"})}}:void 0,duration:1e4})}catch(e){console.error("JobDeclarationProvider: Failed to parse WebSocket message:",e),g({event:"WebSocketParseError",timestamp:new Date().toLocaleString(),level:"ERROR",message:"Failed to parse WebSocket message: ".concat(e instanceof Error?e.message:"Unknown error")})}},e.onerror=e=>{g({event:"WebSocketError",timestamp:new Date().toLocaleString(),level:"ERROR",message:"WebSocket connection error"})},e.onclose=()=>{g({event:"WebSocketClose",timestamp:new Date().toLocaleString(),level:"WARNING",message:"Disconnected from job declaration stream"})},()=>{h.current&&(h.current.close(),h.current=null)}},[a,g]);let p=(0,l.useCallback)(async e=>{if(!d)return s.oR.error("No template available",{description:"Please wait for a new template notification before declaring a job."}),!1;if(0===e.length)return s.oR.error("No transactions selected",{description:"Please select at least one transaction to declare a job."}),!1;x(!0);try{let t=await fetch("http://localhost:3001/api/job-declaration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template_id:d,txids:e})}),a=await t.json();if(a.success){s.oR.success("Job Declaration Successful!",{description:"Successfully declared job with ".concat(e.length," transactions for template ").concat(d,".")});let t={event:"JobDeclarationSuccess",timestamp:new Date().toLocaleString(),level:"INFO",message:"Job declared successfully with ".concat(e.length," transactions (template_id: ").concat(d,")")};return g(t),!0}{s.oR.error("Job Declaration Failed",{description:a.message||"An unknown error occurred."});let e={event:"JobDeclarationError",timestamp:new Date().toLocaleString(),level:"ERROR",message:"Job declaration failed: ".concat(a.message||"Unknown error")};return g(e),!1}}catch(t){let e=t instanceof Error?t.message:"Network error";return s.oR.error("Job Declaration Failed",{description:"Failed to declare job: ".concat(e)}),g({event:"JobDeclarationError",timestamp:new Date().toLocaleString(),level:"ERROR",message:"Job declaration failed: ".concat(e)}),!1}finally{x(!1)}},[d,g]);return(0,n.jsx)(o.Provider,{value:{logs:r,currentTemplateId:d,declareJob:p,isLoading:m,addLog:g},children:t})}function c(){let e=(0,l.useContext)(o);if(void 0===e)throw Error("useJobDeclaration must be used within a JobDeclarationProvider");return e}function d(){let{logs:e,addLog:t}=c();return{logs:e,addLog:t}}function u(){let{currentTemplateId:e,declareJob:t,isLoading:a}=c();return{currentTemplateId:e,declareJob:t,isLoading:a}}},9438:(e,t,a)=>{"use strict";a.d(t,{Transactions:()=>e0});var n=a(5155),l=a(2115),i=a(3464),s=a(1320),o=a(6671),r=a(9434),c=a(6127),d=a(6695),u=a(285),m=a(6268),x=a(5127);let h={sortOrders:[{label:"Asc",value:"asc"},{label:"Desc",value:"desc"}]};function g(e){let{column:t,withBorder:a=!1}=e,n=t.getIsPinned(),l="left"===n&&t.getIsLastColumn("left"),i="right"===n&&t.getIsFirstColumn("right");return{boxShadow:a?l?"-4px 0 4px -4px hsl(var(--border)) inset":i?"4px 0 4px -4px hsl(var(--border)) inset":void 0:void 0,left:"left"===n?"".concat(t.getStart("left"),"px"):void 0,right:"right"===n?"".concat(t.getAfter("right"),"px"):void 0,opacity:n?.97:1,position:n?"sticky":"relative",background:"hsl(var(--background))",width:t.getSize(),zIndex:+!!n}}var p=a(2278),f=a(2767),b=a(9409),v=a(3096);function j(e){let{table:t,pageSizeOptions:a=[10,20,30,40,50],className:l,...i}=e;return(0,n.jsxs)("div",{className:(0,r.cn)("flex w-full flex-col-reverse items-center justify-between gap-4 overflow-auto p-1 sm:flex-row sm:gap-8",l),...i,children:[(0,n.jsx)("div",{className:"text-muted-foreground flex-1 text-sm whitespace-nowrap",children:t.getFilteredSelectedRowModel().rows.length>0?(0,n.jsxs)(n.Fragment,{children:[t.getFilteredSelectedRowModel().rows.length," of"," ",t.getFilteredRowModel().rows.length," row(s) selected."]}):(0,n.jsxs)(n.Fragment,{children:[t.getFilteredRowModel().rows.length," row(s) total."]})}),(0,n.jsxs)("div",{className:"flex flex-col-reverse items-center gap-4 sm:flex-row sm:gap-6 lg:gap-8",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium whitespace-nowrap",children:"Rows per page"}),(0,n.jsxs)(b.l6,{value:"".concat(t.getState().pagination.pageSize),onValueChange:e=>{t.setPageSize(Number(e))},children:[(0,n.jsx)(b.bq,{className:"h-8 w-[4.5rem] [&[data-size]]:h-8",children:(0,n.jsx)(b.yv,{placeholder:t.getState().pagination.pageSize})}),(0,n.jsx)(b.gC,{side:"top",children:a.map(e=>(0,n.jsx)(b.eb,{value:"".concat(e),children:e},e))})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",t.getState().pagination.pageIndex+1," of"," ",t.getPageCount()]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(u.$,{"aria-label":"Go to first page",variant:"outline",size:"icon",className:"hidden size-8 lg:flex",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),children:(0,n.jsx)(p.A,{})}),(0,n.jsx)(u.$,{"aria-label":"Go to previous page",variant:t.getCanPreviousPage()?"default":"outline",size:"icon",className:"size-8",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:(0,n.jsx)(v.YJP,{})}),(0,n.jsx)(u.$,{"aria-label":"Go to next page",variant:t.getCanNextPage()?"default":"outline",size:"icon",className:"size-8",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:(0,n.jsx)(v.vKP,{})}),(0,n.jsx)(u.$,{"aria-label":"Go to last page",variant:"outline",size:"icon",className:"hidden size-8 lg:flex",onClick:()=>t.setPageIndex(t.getPageCount()-1),disabled:!t.getCanNextPage(),children:(0,n.jsx)(f.A,{})})]})]})]})}function w(e){var t;let{table:a,actionBar:l,children:i,className:s,...o}=e;return(0,n.jsxs)("div",{className:(0,r.cn)("flex w-full flex-col gap-2.5 overflow-auto",s),...o,children:[i,(0,n.jsx)("div",{className:"overflow-hidden rounded-md border",children:(0,n.jsxs)(x.Table,{children:[(0,n.jsx)(x.TableHeader,{children:a.getHeaderGroups().map(e=>(0,n.jsx)(x.TableRow,{children:e.headers.map(e=>(0,n.jsx)(x.TableHead,{colSpan:e.colSpan,style:{...g({column:e.column})},className:"text-muted-foreground",children:e.isPlaceholder?null:(0,m.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,n.jsx)(x.TableBody,{children:(null==(t=a.getRowModel().rows)?void 0:t.length)?a.getRowModel().rows.map(e=>(0,n.jsx)(x.TableRow,{"data-state":e.getIsSelected()&&"selected",className:(0,r.cn)("hover:ring-primary hover:ring-1"),children:e.getVisibleCells().map(e=>(0,n.jsx)(x.TableCell,{style:{...g({column:e.column})},children:(0,m.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(x.TableRow,{children:(0,n.jsx)(x.TableCell,{colSpan:a.getAllColumns().length,className:"h-24 text-center",children:"No results."})})})]})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,n.jsx)(j,{table:a}),l&&a.getFilteredSelectedRowModel().rows.length>0&&l]})]})}var S=a(9145),y=a(8922),N=a(2525),C=a(6126),T=a(4636),k=a(5143),R=a(1206),A=a(402),z=a(8266),F=a(9708);function I(e,t){let{checkForDefaultPrevented:a=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(n){if(null==e||e(n),!1===a||!n.defaultPrevented)return null==t?void 0:t(n)}}function E(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function D(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return l.useCallback(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return e=>{let a=!1,n=t.map(t=>{let n=E(t,e);return a||"function"!=typeof n||(a=!0),n});if(a)return()=>{for(let e=0;e<n.length;e++){let a=n[e];"function"==typeof a?a():E(t[e],null)}}}}(...t),t)}var M=a(7650);let P={vertical:{modifiers:[R.FN,R.gj],strategy:A._G,collisionDetection:k.fp},horizontal:{modifiers:[R.dU,R.gj],strategy:A.m$,collisionDetection:k.fp},mixed:{modifiers:[R.gj],strategy:void 0,collisionDetection:k.y$}},B="Sortable",_="SortableContent",L="SortableItem",O="SortableItemHandle",W="SortableOverlay",J={[B]:"`".concat(B,"` components must be within `").concat(B,"`"),[_]:"`".concat(_,"` must be within `").concat(B,"`"),[L]:"`".concat(L,"` must be within `").concat(_,"`"),[O]:"`".concat(O,"` must be within `").concat(L,"`"),[W]:"`".concat(W,"` must be within `").concat(B,"`")},V=l.createContext(null);function K(e){let t=l.useContext(V);if(!t)throw Error(J[e]);return t}function q(e){let{value:t,onValueChange:a,collisionDetection:i,modifiers:s,strategy:o,onMove:r,orientation:c="vertical",flatCursor:d=!1,getItemValue:u,accessibility:m,...x}=e,h=l.useId(),[g,p]=l.useState(null),f=(0,k.FR)((0,k.MS)(k.cA),(0,k.MS)(k.IG),(0,k.MS)(k.uN,{coordinateGetter:A.JR})),b=l.useMemo(()=>P[c],[c]),v=l.useCallback(e=>{if("object"==typeof e&&!u)throw Error("getItemValue is required when using array of objects.");return u?u(e):e},[u]),j=l.useMemo(()=>t.map(e=>v(e)),[t,v]),w=l.useCallback(e=>{let{active:n,over:l}=e;if(l&&n.id!==(null==l?void 0:l.id)){let i=t.findIndex(e=>v(e)===n.id),s=t.findIndex(e=>v(e)===l.id);r?r({...e,activeIndex:i,overIndex:s}):null==a||a((0,A.be)(t,i,s))}p(null)},[t,a,r,v]),S=l.useMemo(()=>({onDragStart(e){var a;let{active:n}=e,l=n.id.toString();return'Grabbed sortable item "'.concat(l,'". Current position is ').concat((null==(a=n.data.current)?void 0:a.sortable.index)+1," of ").concat(t.length,". Use arrow keys to move, space to drop.")},onDragOver(e){let{active:a,over:n}=e;if(n){var l,i,s,o;let e=null!=(s=null==(l=n.data.current)?void 0:l.sortable.index)?s:0,r=null!=(o=null==(i=a.data.current)?void 0:i.sortable.index)?o:0,c=a.id.toString();return'Sortable item "'.concat(c,'" moved ').concat(e>r?"down":"up"," to position ").concat(e+1," of ").concat(t.length,".")}return"Sortable item is no longer over a droppable area. Press escape to cancel."},onDragEnd(e){let{active:a,over:n}=e,l=a.id.toString();if(n){var i,s;let e=null!=(s=null==(i=n.data.current)?void 0:i.sortable.index)?s:0;return'Sortable item "'.concat(l,'" dropped at position ').concat(e+1," of ").concat(t.length,".")}return'Sortable item "'.concat(l,'" dropped. No changes were made.')},onDragCancel(e){var a,n;let{active:l}=e,i=null!=(n=null==(a=l.data.current)?void 0:a.sortable.index)?n:0,s=l.id.toString();return'Sorting cancelled. Sortable item "'.concat(s,'" returned to position ').concat(i+1," of ").concat(t.length,".")},onDragMove(e){let{active:a,over:n}=e;if(n){var l,i,s,o;let e=null!=(s=null==(l=n.data.current)?void 0:l.sortable.index)?s:0,r=null!=(o=null==(i=a.data.current)?void 0:i.sortable.index)?o:0,c=a.id.toString();return'Sortable item "'.concat(c,'" is moving ').concat(e>r?"down":"up"," to position ").concat(e+1," of ").concat(t.length,".")}return"Sortable item is no longer over a droppable area. Press escape to cancel."}}),[t]),y=l.useMemo(()=>({draggable:"\n        To pick up a sortable item, press space or enter.\n        While dragging, use the ".concat("vertical"===c?"up and down":"horizontal"===c?"left and right":"arrow"," keys to move the item.\n        Press space or enter again to drop the item in its new position, or press escape to cancel.\n      ")}),[c]),N=l.useMemo(()=>({id:h,items:j,modifiers:null!=s?s:b.modifiers,strategy:null!=o?o:b.strategy,activeId:g,setActiveId:p,getItemValue:v,flatCursor:d}),[h,j,s,o,b.modifiers,b.strategy,g,v,d]);return(0,n.jsx)(V.Provider,{value:N,children:(0,n.jsx)(k.Mp,{collisionDetection:null!=i?i:b.collisionDetection,modifiers:null!=s?s:b.modifiers,sensors:f,...x,id:h,onDragStart:I(x.onDragStart,e=>{let{active:t}=e;return p(t.id)}),onDragEnd:I(x.onDragEnd,w),onDragCancel:I(x.onDragCancel,()=>p(null)),accessibility:{announcements:S,screenReaderInstructions:y,...m}})})}V.displayName=B;let H=l.createContext(!1);H.displayName=_;let U=l.forwardRef((e,t)=>{let{strategy:a,asChild:l,withoutSlot:i,children:s,...o}=e,r=K(_),c=l?F.DX:"div";return(0,n.jsx)(H.Provider,{value:!0,children:(0,n.jsx)(A.gB,{items:r.items,strategy:null!=a?a:r.strategy,children:i?s:(0,n.jsx)(c,{...o,ref:t,children:s})})})});U.displayName=_;let $=l.createContext(null);$.displayName=L;let G=l.forwardRef((e,t)=>{let{value:a,style:i,asHandle:s,asChild:o,disabled:c,className:d,...u}=e,m=l.useContext(H),x=l.useContext(X);if(!m&&!x)throw Error(J[L]);if(""===a)throw Error("`".concat(L,"` value cannot be an empty string"));let h=K(L),g=l.useId(),{attributes:p,listeners:f,setNodeRef:b,setActivatorNodeRef:v,transform:j,transition:w,isDragging:S}=(0,A.gl)({id:a,disabled:c}),y=D(t,e=>{!c&&(b(e),s&&v(e))}),N=l.useMemo(()=>({transform:z.Ks.Translate.toString(j),transition:w,...i}),[j,w,i]),C=l.useMemo(()=>({id:g,attributes:p,listeners:f,setActivatorNodeRef:v,isDragging:S,disabled:c}),[g,p,f,v,S,c]),T=o?F.DX:"div";return(0,n.jsx)($.Provider,{value:C,children:(0,n.jsx)(T,{id:g,"data-dragging":S?"":void 0,...u,...s?p:{},...s?f:{},tabIndex:c?void 0:0,ref:y,style:N,className:(0,r.cn)("focus-visible:ring-ring focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden",{"touch-none select-none":s,"cursor-default":h.flatCursor,"data-dragging:cursor-grabbing":!h.flatCursor,"cursor-grab":!S&&s&&!h.flatCursor,"opacity-50":S,"pointer-events-none opacity-50":c},d)})})});G.displayName=L;let Z=l.forwardRef((e,t)=>{let{asChild:a,disabled:i,className:s,...o}=e,c=l.useContext($);if(!c)throw Error(J[O]);let d=K(O),u=null!=i?i:c.disabled,m=D(t,e=>{u&&c.setActivatorNodeRef(e)}),x=a?F.DX:"button";return(0,n.jsx)(x,{type:"button","aria-controls":c.id,"data-dragging":c.isDragging?"":void 0,...o,...c.attributes,...c.listeners,ref:m,className:(0,r.cn)("select-none disabled:pointer-events-none disabled:opacity-50",d.flatCursor?"cursor-default":"cursor-grab data-dragging:cursor-grabbing",s),disabled:u})});Z.displayName=O;let X=l.createContext(!1);X.displayName=W;let Y={sideEffects:(0,k.WB)({styles:{active:{opacity:"0.4"}}})};function Q(e){var t;let{container:a,children:i,...s}=e,o=K(W),[c,d]=l.useState(!1);l.useLayoutEffect(()=>d(!0),[]);let u=null!=a?a:c?null==(t=globalThis.document)?void 0:t.body:null;return u?M.createPortal((0,n.jsx)(k.Hd,{dropAnimation:Y,modifiers:o.modifiers,className:(0,r.cn)(!o.flatCursor&&"cursor-grabbing"),...s,children:(0,n.jsx)(X.Provider,{value:!0,children:o.activeId?"function"==typeof i?i({value:o.activeId}):i:null})}),u):null}let ee=["backspace","delete"];function et(e){let{table:t,...a}=e,i=l.useId(),s=l.useId(),o=l.useId(),[c,d]=l.useState(!1),m=l.useRef(null),x=t.getState().sorting,h=t.setSorting,{columnLabels:g,columns:p}=l.useMemo(()=>{let e=new Map,a=new Set(x.map(e=>e.id)),n=[];for(let s of t.getAllColumns()){var l,i;if(!s.getCanSort())continue;let t=null!=(i=null==(l=s.columnDef.meta)?void 0:l.label)?i:s.id;e.set(s.id,t),a.has(s.id)||n.push({id:s.id,label:t})}return{columnLabels:e,columns:n}},[x,t]),f=l.useCallback(()=>{let e=p[0];e&&h(t=>[...t,{id:e.id,desc:!1}])},[p,h]),b=l.useCallback((e,t)=>{h(a=>a?a.map(a=>a.id===e?{...a,...t}:a):a)},[h]),v=l.useCallback(e=>{h(t=>t.filter(t=>t.id!==e))},[h]),j=l.useCallback(()=>h(t.initialState.sorting),[h,t.initialState.sorting]);l.useEffect(()=>{function e(e){!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&("s"!==e.key.toLowerCase()||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),d(!0)),"s"===e.key.toLowerCase()&&e.shiftKey&&x.length>0&&(e.preventDefault(),j()))}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[x.length,j]);let w=l.useCallback(e=>{ee.includes(e.key.toLowerCase())&&x.length>0&&(e.preventDefault(),j())},[x.length,j]);return(0,n.jsxs)(q,{value:x,onValueChange:h,getItemValue:e=>e.id,children:[(0,n.jsxs)(T.AM,{open:c,onOpenChange:d,children:[(0,n.jsx)(T.Wv,{asChild:!0,children:(0,n.jsxs)(u.$,{variant:"outline",size:"sm",onKeyDown:w,children:[(0,n.jsx)(y.A,{}),"Sort",x.length>0&&(0,n.jsx)(C.E,{variant:"default",className:"h-[18.24px] rounded-[3.2px] px-[5.12px] font-mono text-[10.4px] font-normal",children:x.length})]})}),(0,n.jsxs)(T.hl,{"aria-labelledby":s,"aria-describedby":o,className:"flex w-full max-w-[var(--radix-popover-content-available-width)] origin-[var(--radix-popover-content-transform-origin)] flex-col gap-3.5 p-4 sm:min-w-[380px]",...a,children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("h4",{id:s,className:"leading-none font-medium",children:x.length>0?"Sort by":"No sorting applied"}),(0,n.jsx)("p",{id:o,className:(0,r.cn)("text-muted-foreground text-sm",x.length>0&&"sr-only"),children:x.length>0?"Modify sorting to organize your rows.":"Add sorting to organize your rows."})]}),x.length>0&&(0,n.jsx)(U,{asChild:!0,children:(0,n.jsx)("div",{role:"list",className:"flex max-h-[300px] flex-col gap-2 overflow-y-auto p-1",children:x.map(e=>(0,n.jsx)(ea,{sort:e,sortItemId:"".concat(i,"-sort-").concat(e.id),columns:p,columnLabels:g,onSortUpdate:b,onSortRemove:v},e.id))})}),(0,n.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,n.jsx)(u.$,{size:"sm",className:"rounded",ref:m,onClick:f,disabled:0===p.length,children:"Add sort"}),x.length>0&&(0,n.jsx)(u.$,{variant:"outline",size:"sm",className:"rounded",onClick:j,children:"Reset sorting"})]})]})]}),(0,n.jsx)(Q,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"bg-primary/10 h-8 w-[180px] rounded-sm"}),(0,n.jsx)("div",{className:"bg-primary/10 h-8 w-24 rounded-sm"}),(0,n.jsx)("div",{className:"bg-primary/10 size-8 shrink-0 rounded-sm"}),(0,n.jsx)("div",{className:"bg-primary/10 size-8 shrink-0 rounded-sm"})]})})]})}function ea(e){let{sort:t,sortItemId:a,columnLabels:i,onSortUpdate:s,onSortRemove:o}=e,r="".concat(a,"-field-listbox"),c="".concat(a,"-field-trigger"),d="".concat(a,"-direction-listbox"),[m,x]=l.useState(!1),[g,p]=l.useState(!1),f=l.useCallback(e=>{!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&(m||g||ee.includes(e.key.toLowerCase())&&(e.preventDefault(),o(t.id)))},[t.id,m,g,o]);return(0,n.jsx)(G,{value:t.id,asChild:!0,children:(0,n.jsxs)("div",{role:"listitem",id:a,tabIndex:-1,className:"flex items-center gap-2",onKeyDown:f,children:[(0,n.jsx)(T.AM,{open:m,onOpenChange:x,children:(0,n.jsx)(T.Wv,{asChild:!0,children:(0,n.jsxs)(u.$,{id:c,role:"combobox","aria-controls":r,variant:"outline",size:"sm",className:"w-44 justify-between rounded font-normal",children:[(0,n.jsx)("span",{className:"truncate",children:i.get(t.id)}),(0,n.jsx)(v.TBE,{className:"opacity-50"})]})})}),(0,n.jsxs)(b.l6,{open:g,onOpenChange:p,value:t.desc?"desc":"asc",onValueChange:e=>s(t.id,{desc:"desc"===e}),children:[(0,n.jsx)(b.bq,{"aria-controls":d,className:"h-8 w-24 rounded [&[data-size]]:h-8",children:(0,n.jsx)(b.yv,{})}),(0,n.jsx)(b.gC,{id:d,className:"min-w-[var(--radix-select-trigger-width)] origin-[var(--radix-select-content-transform-origin)]",children:h.sortOrders.map(e=>(0,n.jsx)(b.eb,{value:e.value,children:e.label},e.value))})]}),(0,n.jsx)(u.$,{"aria-controls":a,variant:"outline",size:"icon",className:"size-8 shrink-0 rounded",onClick:()=>o(t.id),children:(0,n.jsx)(N.A,{})}),(0,n.jsx)(Z,{asChild:!0,children:(0,n.jsx)(u.$,{variant:"outline",size:"icon",className:"size-8 shrink-0 rounded",children:(0,n.jsx)(v.YtH,{})})})]})})}var en=a(2346),el=a(6102),ei=a(4631),es=a(5084),eo=a(8192);function er(e){var t;let{table:a,visible:i,container:s,children:o,className:c,...d}=e,[u,m]=l.useState(!1);l.useLayoutEffect(()=>{m(!0)},[]),l.useEffect(()=>{function e(e){"Escape"===e.key&&a.toggleAllRowsSelected(!1)}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]);let x=null!=s?s:u?null==(t=globalThis.document)?void 0:t.body:null;if(!x)return null;let h=null!=i?i:a.getFilteredSelectedRowModel().rows.length>0;return M.createPortal((0,n.jsx)(es.N,{children:h&&(0,n.jsx)(eo.P.div,{role:"toolbar","aria-orientation":"horizontal",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.2,ease:"easeInOut"},className:(0,r.cn)("bg-background text-foreground fixed inset-x-0 bottom-6 z-50 mx-auto flex w-fit flex-wrap items-center justify-center gap-2 rounded-md border p-2 shadow-sm",c),...d,children:o})}),x)}function ec(e){let{size:t="sm",tooltip:a,isPending:l,disabled:i,className:s,children:o,...c}=e,d=(0,n.jsx)(u.$,{variant:"secondary",size:t,className:(0,r.cn)("border-secondary bg-secondary/50 hover:bg-secondary/70 gap-1.5 border [&>svg]:size-3.5","icon"===t?"size-7":"h-7",s),disabled:i||l,...c,children:l?(0,n.jsx)(ei.A,{className:"animate-spin"}):o});return a?(0,n.jsxs)(el.m_,{children:[(0,n.jsx)(el.k$,{asChild:!0,children:d}),(0,n.jsx)(el.ZI,{sideOffset:6,className:"bg-accent text-foreground border font-semibold dark:bg-zinc-900 [&>span]:hidden",children:(0,n.jsx)("p",{children:a})})]}):d}function ed(e){let{table:t}=e,a=l.useCallback(()=>{t.toggleAllRowsSelected(!1)},[t]);return(0,n.jsxs)("div",{className:"flex h-7 items-center rounded-md border pr-1 pl-2.5",children:[(0,n.jsxs)("span",{className:"text-xs whitespace-nowrap",children:[t.getFilteredSelectedRowModel().rows.length," selected"]}),(0,n.jsx)(en.Separator,{orientation:"vertical",className:"mr-1 ml-2 data-[orientation=vertical]:h-4"}),(0,n.jsxs)(el.m_,{children:[(0,n.jsx)(el.k$,{asChild:!0,children:(0,n.jsx)(u.$,{variant:"ghost",size:"icon",className:"size-5",onClick:a,children:(0,n.jsx)(v.MKb,{className:"size-3.5"})})}),(0,n.jsxs)(el.ZI,{sideOffset:10,className:"bg-accent text-foreground flex items-center gap-2 border px-2 py-1 font-semibold dark:bg-zinc-900 [&>span]:hidden",children:[(0,n.jsx)("p",{children:"Clear selection"}),(0,n.jsx)("kbd",{className:"bg-background text-foreground rounded border px-1.5 py-px font-mono text-[0.7rem] font-normal shadow-xs select-none",children:(0,n.jsx)("abbr",{title:"Escape",className:"no-underline",children:"Esc"})})]})]})]})}var eu=a(3977),em=a(408);class ex{static filterTransactions(e,t){if(!t.enabled)return[];let a=e.filter(e=>!(e.feeRate<t.minFeeRate)&&(void 0===t.maxSize||!(e.vsize>t.maxSize))&&(void 0===t.minBaseFee||!(e.fees.base<t.minBaseFee))&&(void 0===t.maxAncestorCount||!(e.ancestor_count>t.maxAncestorCount))&&(void 0===t.maxDescendantCount||!(e.descendant_count>t.maxDescendantCount))&&(!t.excludeBip125Replaceable||!e.bip125_replaceable)&&(!t.excludeUnbroadcast||!e.unbroadcast)&&!0);return void 0!==t.maxTransactionCount&&(a=a.slice(0,t.maxTransactionCount)),a}static getMatchingSummary(e,t){if(!t.enabled)return{total:e.length,matching:0,willSelect:0};let a=this.filterTransactions(e,t),n=t.maxTransactionCount?Math.min(a.length,t.maxTransactionCount):a.length;return{total:e.length,matching:a.length,willSelect:n}}static validateCriteria(e){let t=[];return void 0!==e.maxTransactionCount&&e.maxTransactionCount<=0&&t.push("Maximum transaction count must be greater than 0"),t}static getCriteriaDescription(e){if(!e.enabled)return"Auto-selection is disabled";let t=[];return t.push("Min fee rate: ".concat(e.minFeeRate," sat/vB")),void 0!==e.maxSize&&t.push("Max size: ".concat(e.maxSize," vBytes")),void 0!==e.maxTransactionCount&&t.push("Max ".concat(e.maxTransactionCount," transactions")),e.excludeBip125Replaceable&&t.push("Exclude BIP125 replaceable"),e.excludeUnbroadcast&&t.push("Exclude unbroadcast"),t.length>0?t.join(", "):"No specific criteria"}}async function eh(e,t,a,n,l,i,s){try{let o=function(e){let t=new URLSearchParams;return t.append("selectionStrategy",e.selectionStrategy),t.append("minFeeRate",e.minFeeRate.toString()),[{key:"maxSize",value:e.maxSize},{key:"minBaseFee",value:e.minBaseFee},{key:"maxAncestorCount",value:e.maxAncestorCount},{key:"maxDescendantCount",value:e.maxDescendantCount},{key:"excludeBip125Replaceable",value:e.excludeBip125Replaceable},{key:"excludeUnbroadcast",value:e.excludeUnbroadcast},{key:"maxTransactionCount",value:e.maxTransactionCount}].forEach(e=>{let{key:a,value:n,shouldInclude:l}=e;void 0!==n&&(!l||l(n))&&t.append(a,n.toString())}),t}(e),r="http://localhost:3001/api/auto-select?".concat(o.toString()),c=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok)throw Error("Auto-select API error: ".concat(c.status," ").concat(c.statusText));let d=await c.json();if(!d.success||!d.data||!Array.isArray(d.data))throw Error("Invalid API response format");await eg(d.data,t,a,n,l,i,s,!1)}catch(c){console.error("Auto-selection API failed, falling back to local filtering:",c),l.general.showNotifications&&o.oR.warning("Using local filtering",{description:"API unavailable, using local transaction filtering",duration:3e3});let r=ex.filterTransactions(t,e);await eg(r,t,a,n,l,i,s,!0)}}async function eg(e,t,a,n,l,i,s,r){if(0===e.length){l.general.showNotifications&&o.oR.info("No matching transactions",{description:"No transactions match the current auto-selection criteria",duration:3e3});return}let c=new Set(t.map(e=>e.txid)),d=e.map(e=>e.txid).filter(e=>c.has(e));if(0===d.length){l.general.showNotifications&&o.oR.warning("No valid transactions",{description:"Matching transactions are no longer in the mempool",duration:3e3});return}l.autoSelection.onNewTemplate.clearExistingSelections&&(i.onSelectTransactions([]),await new Promise(e=>setTimeout(e,100)));let u=new Set(a),m=d.filter(e=>!u.has(e)),x=d.filter(e=>u.has(e));if(l.general.pauseOnSelection&&s&&i.onToggleFetching&&i.onToggleFetching(),i.onSelectTransactions(d),l.general.showNotifications){let e=l.autoSelection.onNewTemplate.requireTemplate&&n?" for template ".concat(n):"",t=function(e,t,a,n,l,i){let s=i?" using local criteria":"";return n?"Selected ".concat(e," transactions").concat(l," (cleared previous selections)").concat(s):t>0&&a>0?"Added ".concat(t," new transactions (").concat(a," already selected)").concat(l).concat(s):t>0?"Selected ".concat(t," transactions").concat(l).concat(s):"All ".concat(a," matching transactions were already selected").concat(l).concat(s)}(d.length,m.length,x.length,l.autoSelection.onNewTemplate.clearExistingSelections,e,r);o.oR.success("Auto-selection ".concat(r?"(local)":"completed"),{description:t,duration:5e3})}l.general.autoScrollToTable&&setTimeout(()=>{let e=document.querySelector(".data-table-container");e&&e.scrollIntoView({behavior:"smooth"})},100),l.autoSelection.onNewTemplate.autoJobDeclaration&&i.onDeclareJob&&n&&d.length>0&&await ep(d,n,i.onDeclareJob,l.general.showNotifications,r)}async function ep(e,t,a,n,l){try{await new Promise(e=>setTimeout(e,200)),await a(e)&&n&&o.oR.success("Auto job declaration ".concat(l?"(local)":"completed"),{description:"Successfully declared job with ".concat(e.length," transactions for template ").concat(t),duration:5e3})}catch(e){console.error("Auto job declaration failed:",e),n&&o.oR.error("Auto job declaration failed",{description:"Failed to automatically declare job".concat(l?" (local mode)":""),duration:5e3})}}var ef=a(4382),eb=a(1539),ev=a(2486),ej=a(5690),ew=a(381),eS=a(5057),ey=a(2523),eN=a(333);let eC=[{value:"maximizeFees",label:"Maximize Fees",description:"Select transactions to maximize total fees (default)"},{value:"maximizeCount",label:"Maximize Count",description:"Select maximum number of transactions"},{value:"balanced",label:"Balanced",description:"Balanced approach between fees and count"},{value:"compact",label:"Compact",description:"Efficient fee/weight ratio selection"},{value:"maxCapacity",label:"Max Capacity",description:"Fill maximum block capacity"}];function eT(e){let{onClose:t}=e,{autoSelection:a,updateAutoSelection:i}=(0,em.sA)(),s=a.onNewTemplate,[o,r]=(0,l.useState)("idle"),[c,d]=(0,l.useState)(s),m=e=>{d(t=>({...t,...e}))},x=JSON.stringify(c)!==JSON.stringify(s);return(0,n.jsxs)("div",{className:"space-y-6 px-1",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(eS.J,{className:"text-base font-medium",children:"Enable Auto-Selection"}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:"Automatically select transactions when new templates arrive"})]}),(0,n.jsx)(eN.d,{checked:c.enabled,onCheckedChange:e=>m({enabled:e})})]}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(en.Separator,{}),(0,n.jsxs)("div",{className:"flex items-end justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,n.jsx)(eS.J,{className:"text-lg",children:"Selection Strategy"}),(0,n.jsxs)(b.l6,{value:c.selectionStrategy,onValueChange:e=>m({selectionStrategy:e}),children:[(0,n.jsx)(b.bq,{children:(0,n.jsx)(b.yv,{placeholder:"Select strategy"})}),(0,n.jsx)(b.gC,{children:eC.map(e=>(0,n.jsx)(b.eb,{value:e.value,children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"font-medium",children:e.label}),(0,n.jsx)("div",{className:"text-muted-foreground text-xs",children:e.description})]})},e.value))})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 pb-1",children:[x&&(0,n.jsx)(u.$,{onClick:()=>{d(s)},variant:"outline",className:"min-w-[80px]",children:"Reset"}),(0,n.jsxs)(u.$,{onClick:()=>{r("saving"),i({onNewTemplate:c}),setTimeout(()=>{r("saved"),setTimeout(()=>r("idle"),2e3)},500)},disabled:"saving"===o||!x,className:"min-w-[100px]",variant:x?"default":"outline",children:["saving"===o&&"Saving...","saved"===o&&"Saved!","idle"===o&&(x?"Save Changes":"No Changes")]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"min-fee-rate",children:"Min Fee Rate (sat/vB)"}),(0,n.jsx)(ey.p,{id:"min-fee-rate",type:"number",value:c.minFeeRate||"",onChange:e=>m({minFeeRate:Number(e.target.value)||1}),placeholder:"1",min:"1"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"max-size",children:"Max Size (vBytes)"}),(0,n.jsx)(ey.p,{id:"max-size",type:"number",value:c.maxSize||"",onChange:e=>m({maxSize:Number(e.target.value)||void 0}),placeholder:"100000"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"min-base-fee",children:"Min Base Fee (sats)"}),(0,n.jsx)(ey.p,{id:"min-base-fee",type:"number",value:c.minBaseFee||"",onChange:e=>m({minBaseFee:Number(e.target.value)||void 0}),placeholder:"1000"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"max-count",children:"Max Transaction Count"}),(0,n.jsx)(ey.p,{id:"max-count",type:"number",value:c.maxTransactionCount||"",onChange:e=>m({maxTransactionCount:Number(e.target.value)||void 0}),placeholder:"100",min:"1"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"max-ancestor",children:"Max Ancestor Count"}),(0,n.jsx)(ey.p,{id:"max-ancestor",type:"number",value:c.maxAncestorCount||"",onChange:e=>m({maxAncestorCount:Number(e.target.value)||void 0}),placeholder:"25",min:"1"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"max-descendant",children:"Max Descendant Count"}),(0,n.jsx)(ey.p,{id:"max-descendant",type:"number",value:c.maxDescendantCount||"",onChange:e=>m({maxDescendantCount:Number(e.target.value)||void 0}),placeholder:"25",min:"1"})]})]}),(0,n.jsx)(en.Separator,{}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium",children:"Selection Preferences"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)(eS.J,{htmlFor:"require-template",children:"Require Template"}),(0,n.jsx)("p",{className:"text-muted-foreground text-xs",children:"Only run auto-selection when a template is available"})]}),(0,n.jsx)(eN.d,{id:"require-template",checked:c.requireTemplate||!1,onCheckedChange:e=>m({requireTemplate:e})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)(eS.J,{htmlFor:"clear-existing",children:"Clear Existing Selections"}),(0,n.jsx)("p",{className:"text-muted-foreground text-xs",children:"Remove current selections before auto-selecting new ones"})]}),(0,n.jsx)(eN.d,{id:"clear-existing",checked:c.clearExistingSelections||!1,onCheckedChange:e=>m({clearExistingSelections:e})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)(eS.J,{htmlFor:"periodic-enabled",children:"Enable Periodic Auto-Selection"}),(0,n.jsx)("p",{className:"text-muted-foreground text-xs",children:"Run auto-selection at regular intervals"})]}),(0,n.jsx)(eN.d,{id:"periodic-enabled",checked:c.periodicEnabled||!1,onCheckedChange:e=>m({periodicEnabled:e})})]}),c.periodicEnabled&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eS.J,{htmlFor:"periodic-interval",children:"Interval (seconds)"}),(0,n.jsx)(ey.p,{id:"periodic-interval",type:"number",value:c.periodicInterval||30,onChange:e=>m({periodicInterval:Number(e.target.value)||30}),placeholder:"30",min:"5",max:"300"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)(eS.J,{htmlFor:"auto-job-declaration",children:"Auto Job Declaration"}),(0,n.jsx)("p",{className:"text-muted-foreground text-xs",children:"Automatically declare job after successful auto-selection"})]}),(0,n.jsx)(eN.d,{id:"auto-job-declaration",checked:c.autoJobDeclaration||!1,onCheckedChange:e=>m({autoJobDeclaration:e})})]})]})]}),(0,n.jsx)(en.Separator,{}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium",children:"Exclusion Preferences"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(eS.J,{htmlFor:"exclude-replaceable",children:"Exclude BIP125 Replaceable"}),(0,n.jsx)(eN.d,{id:"exclude-replaceable",checked:c.excludeBip125Replaceable||!1,onCheckedChange:e=>m({excludeBip125Replaceable:e})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(eS.J,{htmlFor:"exclude-unbroadcast",children:"Exclude Unbroadcast"}),(0,n.jsx)(eN.d,{id:"exclude-unbroadcast",checked:c.excludeUnbroadcast||!1,onCheckedChange:e=>m({excludeUnbroadcast:e})})]})]})]})]})]})}function ek(e){let{currentTemplateId:t,onManualAutoSelection:a}=e,{settings:i}=(0,em.t0)(),[s,o]=(0,l.useState)(!1),r=i.autoSelection.onNewTemplate.enabled,c=i.autoSelection.onNewTemplate.requireTemplate,d=i.autoSelection.onNewTemplate.periodicEnabled,m=i.autoSelection.onNewTemplate.autoJobDeclaration,x=r&&(!c||t);return(0,n.jsxs)("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[r&&(0,n.jsx)(C.E,{variant:"outline",className:"flex items-center gap-1",children:c?"Template Required":"No Template Required"}),r&&d&&(0,n.jsxs)(C.E,{variant:"outline",className:"flex items-center gap-1",children:[(0,n.jsx)(eb.A,{className:"h-3 w-3"}),"Periodic: ",i.autoSelection.onNewTemplate.periodicInterval,"s"]}),r&&m&&(0,n.jsxs)(C.E,{variant:"outline",className:"flex items-center gap-1",children:[(0,n.jsx)(ev.A,{className:"h-3 w-3"}),"Auto Job Declaration"]}),(0,n.jsxs)(u.$,{variant:"outline",size:"sm",onClick:a,disabled:!x,className:"flex items-center gap-2",title:r?c&&!t?"Template required but not available":"Run auto-selection now":"Auto-selection is disabled",children:[(0,n.jsx)(ej.A,{className:"h-3 w-3"}),"Run Auto-Selection"]}),(0,n.jsxs)(u.$,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:()=>o(!0),children:[(0,n.jsx)(ew.A,{className:"h-3 w-3"}),"Settings"]}),(0,n.jsx)(ef.a,{title:"Auto-Selection Settings",description:"Configure auto-selection criteria for transaction selection when new templates arrive.",isOpen:s,onClose:()=>o(!1),size:"5xl",children:(0,n.jsx)(eT,{onClose:()=>o(!1)})})]})}var eR=a(6981),eA=a(5196);function ez(e){let{className:t,...a}=e;return(0,n.jsx)(eR.bL,{"data-slot":"checkbox",className:(0,r.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,n.jsx)(eR.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,n.jsx)(eA.A,{className:"size-3.5"})})})}var eF=a(772),eI=a(1243);function eE(e){let{transaction:t,isSelected:a,onSelectionChange:l,canSelect:i=!0,validationMessage:s="",disabled:o=!1,className:c}=e;return(0,n.jsx)(el.Bc,{children:(0,n.jsxs)(el.m_,{children:[(0,n.jsx)(el.k$,{asChild:!0,children:(0,n.jsx)("div",{className:(0,r.cn)("flex items-center gap-1",c),children:(0,n.jsx)(ez,{checked:a,onCheckedChange:e=>{(!e||i||a)&&l(e)},disabled:o||!i,"aria-label":"Select transaction ".concat(t.txid.slice(0,8),"...")})})}),!i&&s&&(0,n.jsxs)(el.ZI,{side:"right",className:"max-w-xs",children:[(0,n.jsx)("p",{className:"text-sm",children:!i&&s?s:null}),(0,n.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-xs text-orange-200",children:[(0,n.jsx)(eI.A,{className:"h-3 w-3"}),"Validation failed"]})]})]})})}var eD=a(8395);let eM=e=>(0,n.jsx)("div",{className:"flex h-8 items-center justify-center gap-1",children:e}),eP=[{id:"txid",accessorKey:"txid",title:"Txid",formatter:e=>e.slice(0,4)+"..."+e.slice(-4),meta:{label:"txid",placeholder:"Search by txid",variant:"text",icon:eD.A},enableSorting:!1,enableColumnFilter:!0},{id:"feeRate",accessorKey:"feeRate",title:"FeeRate (sat/vB)",formatter:e=>e.toPrecision(4),meta:{label:"Fee Rate",variant:"range",range:[0,1e3]},enableSorting:!0,enableColumnFilter:!0},{id:"vsize",accessorKey:"vsize",title:"Size (vB)",formatter:e=>e,meta:{label:"vsize",variant:"range",range:[0,1e6]},enableSorting:!0,enableColumnFilter:!0},{id:"fees.base",accessorKey:"fees.base",title:"Base Fee (sat)",formatter:e=>e.toLocaleString(),meta:{label:"Base Fee",variant:"range",range:[0,1e6]},enableSorting:!0,enableColumnFilter:!0},{id:"depends",accessorKey:"depends",title:"Depends On",formatter:e=>e.length,meta:{label:"Depends On",variant:"number"},enableSorting:!0,enableColumnFilter:!0,filterFn:(e,t,a)=>e.getValue(t).length===Number(a)},{id:"descendant_count",accessorKey:"descendant_count",title:"Descendant Count",formatter:e=>e,enableSorting:!0,enableColumnFilter:!0},{id:"descendant_size",accessorKey:"descendant_size",title:"Descendant Size",formatter:e=>e,enableSorting:!0,enableColumnFilter:!0},{id:"ancestor_count",accessorKey:"ancestor_count",title:"Ancestor Count",formatter:e=>e,enableSorting:!0,enableColumnFilter:!0},{id:"ancestor_size",accessorKey:"ancestor_size",title:"Ancestor Size",formatter:e=>e,enableSorting:!0,enableColumnFilter:!0},{id:"time",accessorKey:"time",title:"Time",formatter:e=>new Date(1e3*e).toLocaleString(),enableSorting:!0,enableColumnFilter:!0},{id:"height",accessorKey:"height",title:"Height",formatter:e=>e,enableSorting:!0,enableColumnFilter:!0},{id:"bip125_replaceable",accessorKey:"bip125_replaceable",title:"BIP125 Replaceable",formatter:e=>(0,n.jsx)(ez,{checked:e,disabled:!0}),meta:{label:"BIP125 Replaceable",variant:"boolean"},enableSorting:!0,enableColumnFilter:!0}],eB=[{id:"select",header:e=>{let{table:t}=e;return(0,n.jsx)(ez,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>t.toggleAllPageRowsSelected(!!e),"aria-label":"Select all"})},cell:e=>{let{row:t}=e;return(0,n.jsx)(ez,{checked:t.getIsSelected(),onCheckedChange:e=>t.toggleSelected(!!e),"aria-label":"Select row"})},meta:{label:"Checkbox",placeholder:"select transaction",variant:"text",icon:eD.A},size:32,enableHiding:!1},...eP.map(e=>({id:e.id,accessorKey:e.accessorKey,header:t=>{let{column:a}=t;return(0,n.jsx)(eF.w,{column:a,title:e.title,className:"w-full justify-center"})},cell:t=>{let{cell:a}=t;return eM(e.formatter(a.getValue()))},...e.meta&&{meta:e.meta},enableSorting:e.enableSorting,enableColumnFilter:e.enableColumnFilter,...e.filterFn&&{filterFn:e.filterFn}}))],e_=[{id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(ez,{checked:t.getIsSelected(),onCheckedChange:e=>t.toggleSelected(!!e),"aria-label":"Select row"})},meta:{label:"Checkbox",placeholder:"deselect transaction",variant:"text",icon:eD.A},size:32,enableHiding:!1},...eB.slice(1,5)];var eL=a(1032),eO=a(4944);function eW(e){let{isOpen:t,selectedData:a,handleModal:i}=e,s=l.useMemo(()=>{if(0===a.length)return{totalTransactions:0,totalVirtualSize:0,totalWeight:0,totalFees:0,averageFeeRate:0,maxAncestorCount:0,maxDescendantCount:0};let e=a.length,t=a.reduce((e,t)=>e+t.vsize,0),n=a.reduce((e,t)=>e+(t.weight||4*t.vsize),0),l=a.reduce((e,t)=>e+t.fees.base,0);return{totalTransactions:e,totalVirtualSize:t,totalWeight:n,totalFees:l,averageFeeRate:t>0?l/t:0,maxAncestorCount:Math.max(...a.map(e=>e.ancestor_count)),maxDescendantCount:Math.max(...a.map(e=>e.descendant_count))}},[a]),o=s.totalWeight/4e6*100;return(0,n.jsx)(ef.a,{title:"Transaction Summary",description:"Aggregate statistics for selected transactions",isOpen:t,onClose:()=>i(!1),size:"4xl",children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{className:"pb-2",children:(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Transactions"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[s.totalTransactions,(0,n.jsx)("span",{className:"text-muted-foreground ml-1 text-sm font-normal",children:"txs"})]})})]}),(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{className:"pb-2",children:(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Virtual Size"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[s.totalVirtualSize,(0,n.jsx)("span",{className:"text-muted-foreground ml-1 text-sm font-normal",children:"vbytes"})]})})]}),(0,n.jsxs)(d.Zp,{children:[(0,n.jsxs)(d.aR,{className:"pb-2",children:[(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Weight"}),(0,n.jsxs)(d.BT,{children:[o.toFixed(2),"% of max block weight"]})]}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[s.totalWeight,(0,n.jsxs)("span",{className:"text-muted-foreground ml-1 text-sm font-normal",children:["/ ",4e6]})]}),(0,n.jsx)(eO.k,{value:Math.min(o,100),className:"h-2"})]})})]}),(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{className:"pb-2",children:(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Fees"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[(s.totalFees/1e8).toFixed(8),(0,n.jsx)("span",{className:"text-muted-foreground ml-1 text-sm font-normal",children:"BTC"})]}),(0,n.jsxs)("div",{className:"text-muted-foreground text-sm",children:[s.totalFees," sats"]})]})})]}),(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{className:"pb-2",children:(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Average Fee Rate"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[s.averageFeeRate.toFixed(1),(0,n.jsx)("span",{className:"text-muted-foreground ml-1 text-sm font-normal",children:"sat/vB"})]})})]}),(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{className:"pb-2",children:(0,n.jsx)(d.ZB,{className:"text-sm font-medium",children:"Chain Metrics"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground text-sm",children:"Max Ancestors:"}),(0,n.jsx)(C.E,{variant:"secondary",children:s.maxAncestorCount})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground text-sm",children:"Max Descendants:"}),(0,n.jsx)(C.E,{variant:"secondary",children:s.maxDescendantCount})]})]})})]})]}),s.totalTransactions>0&&(0,n.jsxs)(d.Zp,{children:[(0,n.jsx)(d.aR,{children:(0,n.jsx)(d.ZB,{className:"text-lg",children:"Additional Details"})}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 text-sm md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Average tx size:"}),(0,n.jsxs)("span",{children:[(s.totalVirtualSize/s.totalTransactions).toFixed(0)," ","vbytes"]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Average tx weight:"}),(0,n.jsxs)("span",{children:[(s.totalWeight/s.totalTransactions).toFixed(0)," ","weight units"]})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Average fee per tx:"}),(0,n.jsxs)("span",{children:[(s.totalFees/s.totalTransactions).toFixed(0)," ","sats"]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Block space usage:"}),(0,n.jsxs)("span",{children:[o.toFixed(4),"%"]})]})]})]})})]})]})})}var eJ=a(6844);let eV={MAX_BLOCK_WEIGHT:4e6};class eK{static validateSelection(e,t){let a=[],n=this.calculateTotalWeight(e),l=n/eV.MAX_BLOCK_WEIGHT*100;n>eV.MAX_BLOCK_WEIGHT&&a.push("Total weight (".concat(n.toLocaleString(),") exceeds Bitcoin block limit (").concat(eV.MAX_BLOCK_WEIGHT.toLocaleString(),")"));let i=this.checkDependencies(e,t);return i.length>0&&a.push("".concat(i.length," transaction(s) have unmet dependencies. Child transactions require their parent transactions to be included.")),{isValid:0===a.length,errors:a,warnings:[],totalWeight:n,weightUtilization:l,dependencyViolations:i}}static canAddTransaction(e,t,a){let n=[...t,e],l=this.validateSelection(n,a),i=this.calculateTotalWeight(t)+this.calculateTotalWeight([e]),s=l.isValid,o=eV.MAX_BLOCK_WEIGHT-i,r="";if(s)r="Can add transaction. Remaining capacity: ".concat(o.toLocaleString()," weight units (").concat((o/eV.MAX_BLOCK_WEIGHT*100).toFixed(1),"%)");else if(i>eV.MAX_BLOCK_WEIGHT)r="Cannot add transaction: would exceed block weight limit by ".concat((i-eV.MAX_BLOCK_WEIGHT).toLocaleString()," weight units");else if(l.dependencyViolations.length>0){var c;let t=(null==(c=l.dependencyViolations.find(t=>t.childTxid===e.txid))?void 0:c.missingParents)||[];r=t.length>0?"Cannot add transaction: missing ".concat(t.length," parent transaction(s)"):"Cannot add transaction: would create dependency violations"}return{canSelect:s,totalSelectedWeight:i,remainingWeight:o,weightUtilization:l.weightUtilization,dependencyIssues:l.dependencyViolations.length,message:r}}static canAddTransactions(e,t,a){let n=[...t,...e],l=this.validateSelection(n,a),i=this.calculateTotalWeight(t)+this.calculateTotalWeight(e),s=l.isValid,o=eV.MAX_BLOCK_WEIGHT-i,r="";return s?r="Can add ".concat(e.length," transaction(s). Remaining capacity: ").concat(o.toLocaleString()," weight units"):i>eV.MAX_BLOCK_WEIGHT?r="Cannot add ".concat(e.length," transaction(s): would exceed block weight limit by ").concat((i-eV.MAX_BLOCK_WEIGHT).toLocaleString()," weight units"):l.dependencyViolations.length>0&&(r="Cannot add ".concat(e.length," transaction(s): would create ").concat(l.dependencyViolations.length," dependency violation(s)")),{canSelect:s,totalSelectedWeight:i,remainingWeight:o,weightUtilization:l.weightUtilization,dependencyIssues:l.dependencyViolations.length,message:r}}static calculateTotalWeight(e){return e.reduce((e,t)=>e+(t.weight||4*t.vsize),0)}static checkDependencies(e,t){let a=new Set(e.map(e=>e.txid)),n=new Set(t.map(e=>e.txid));return e.map(e=>{var t;if(!(null==(t=e.depends)?void 0:t.length))return null;let l=Array.from(new Set(e.depends)).filter(e=>n.has(e.toString())&&!a.has(e.toString()));return l.length?{childTxid:e.txid,missingParents:l}:null}).filter(e=>null!==e)}static getSelectionSummary(e,t){if(0===e.length)return"No transactions selected";let a=this.validateSelection(e,t),n=a.weightUtilization.toFixed(1);return a.isValid?"".concat(e.length," transaction(s) selected (").concat(n,"% block capacity)"):"Invalid selection: ".concat(a.errors.join(", "))}static sortByDependencies(e){let t=new Map(e.map(e=>[e.txid,e])),a=[],n=new Set,l=new Set,i=e=>{if(n.has(e)||l.has(e))return;l.add(e);let s=t.get(e);if(s){if(s.depends&&s.depends.length>0)for(let e of s.depends){let a=String(e);t.has(a)&&i(a)}l.delete(e),n.add(e),a.push(s)}};for(let t of e)i(t.txid);return a}static removeInvalidTransactions(e,t){let a=[],n=[],l=[],i=0;for(let t of[...e].sort((e,t)=>t.feeRate-e.feeRate)){let e=t.weight||4*t.vsize;i+e<=eV.MAX_BLOCK_WEIGHT?(a.push(t),i+=e):(n.push(t),l.push("Removed transaction ".concat(t.txid.slice(0,8),"... (would exceed block weight limit)")))}let s=new Set(a.map(e=>e.txid)),o=new Set(t.map(e=>e.txid)),r=[],c=[];for(let e of a){let t=!0;if(e.depends&&e.depends.length>0)for(let a of e.depends){let e=String(a);if(o.has(e)&&!s.has(e)){t=!1;break}}t?r.push(e):(c.push(e),l.push("Removed transaction ".concat(e.txid.slice(0,8),"... (missing parent dependencies)")))}return{validTransactions:this.sortByDependencies(r),removedTransactions:[...n,...c],issues:l}}static cleanAndOptimizeSelection(e,t){if(0===e.length)return{optimizedTransactions:[],removedTransactions:[],summary:"No transactions to clean",issues:[]};let a=this.removeInvalidTransactions(e,t),n=this.validateSelection(a.validTransactions,t),l=0===a.validTransactions.length?"All transactions were invalid and removed":"Cleaned selection: ".concat(a.validTransactions.length," valid transactions remaining (").concat(n.weightUtilization.toFixed(1),"% block capacity)");return{optimizedTransactions:a.validTransactions,removedTransactions:a.removedTransactions,summary:l,issues:a.issues}}}function eq(e){let{transactions:t,selectedTransactions:a,enableRealTimeValidation:n=!0}=e,i=l.useMemo(()=>n&&0!==a.length?eK.validateSelection(a,t):{isValid:!0,errors:[],warnings:[],totalWeight:0,weightUtilization:0,dependencyViolations:[]},[a,t,n]),s=l.useMemo(()=>eK.getSelectionSummary(a,t),[a,t]),o=l.useMemo(()=>{let e=Math.max(0,4e6-i.totalWeight);return{isValid:i.isValid,totalWeight:i.totalWeight,weightUtilization:i.weightUtilization,dependencyIssues:i.dependencyViolations.length,canAddMore:e>0&&i.isValid,remainingCapacity:e}},[i]),r=l.useCallback(e=>eK.canAddTransaction(e,a,t),[a,t]),c=l.useCallback(e=>eK.canAddTransactions(e,a,t),[a,t]),d=l.useCallback(()=>eK.validateSelection(a,t),[a,t]),u=l.useCallback(e=>eK.sortByDependencies(e),[]);return{canAddTransaction:r,canAddTransactions:c,validateCurrentSelection:d,removeInvalidTransactions:l.useCallback(e=>eK.removeInvalidTransactions(e,t),[t]),cleanAndOptimizeSelection:l.useCallback(e=>eK.cleanAndOptimizeSelection(e,t),[t]),selectionSummary:s,validationState:o,sortByDependencies:u}}function eH(e){let{isOpen:t,selectedData:a,parentTable:i,handleModal:s,allTransactions:r}=e,[c,d]=l.useState(0),[x,h]=l.useState(10),[g,p]=l.useState([]),[f,b]=l.useState(!1),{declareJob:v,isLoading:j,currentTemplateId:y}=(0,eJ.Ou)(),{cleanAndOptimizeSelection:C}=eq({transactions:r,selectedTransactions:a,enableRealTimeValidation:!0}),T=async()=>{let e=a.map(e=>e.txid);await v(e)&&(i.toggleAllRowsSelected(!1),setTimeout(()=>s(!1),1e3))},k=l.useMemo(()=>e_.map(e=>"select"===e.id?{...e,cell:e=>{var t,a;let{row:l}=e,s=()=>{try{return i.getRow(l.original.txid)}catch(e){return null}};return(0,n.jsx)(ez,{checked:null!=(a=null==(t=s())?void 0:t.getIsSelected())&&a,onCheckedChange:e=>{let t=s();t&&t.toggleSelected(!!e)},"aria-label":"Select row"})}}:e),[i]),R=(0,m.N4)({data:a,columns:k,state:{pagination:{pageIndex:c,pageSize:x},sorting:g},onPaginationChange:e=>{if("function"==typeof e){let t=e({pageIndex:c,pageSize:x});d(t.pageIndex),h(t.pageSize)}else d(e.pageIndex),h(e.pageSize)},onSortingChange:p,getCoreRowModel:(0,eL.HT)(),getPaginationRowModel:(0,eL.kW)(),getSortedRowModel:(0,eL.h5)()});return(0,n.jsxs)(ef.a,{title:"Selected Transactions",description:"Review the selected transactions",isOpen:t,onClose:()=>s(!1),size:"6xl",children:[(0,n.jsx)("div",{className:"max-h-[75vh] overflow-auto",children:(0,n.jsx)(w,{table:R,children:(0,n.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2",children:[(0,n.jsx)(S.w,{table:R}),(0,n.jsx)(et,{table:R}),a.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(u.$,{variant:y?"default":"secondary",size:"sm",onClick:T,disabled:!y||j,children:[(0,n.jsx)(ev.A,{className:"h-4 w-4"}),j?"Declaring...":"Declare Job"]}),(0,n.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>b(!0),children:"Summary"}),(0,n.jsxs)(u.$,{variant:"outline",size:"sm",onClick:()=>{if(0===a.length)return void o.oR.info("No transactions selected to clean");let e=C(a);if(0===e.removedTransactions.length)return void o.oR.success("All selected transactions are valid");i.toggleAllRowsSelected(!1),setTimeout(()=>{e.optimizedTransactions.forEach(e=>{try{let t=i.getRow(e.txid);t&&t.toggleSelected(!0)}catch(t){console.warn("Transaction ".concat(e.txid," not found in current table data"))}})},100),o.oR.success("Selection cleaned",{description:"Removed ".concat(e.removedTransactions.length," invalid transaction(s). ").concat(e.summary)})},disabled:0===a.length,children:[(0,n.jsx)(N.A,{className:"h-4 w-4"}),"Clean Invalid"]}),(0,n.jsx)(u.$,{variant:"destructive",size:"sm",onClick:()=>{i.toggleAllRowsSelected(!1),setTimeout(()=>s(!1),800)},children:"Deselect All"})]})]})})}),(0,n.jsx)(eW,{isOpen:f,selectedData:a,handleModal:b})]})}var eU=a(646);function e$(e){let{validationState:t,selectionSummary:a,selectedCount:l}=e,i=Math.min(t.weightUtilization,100);return(0,n.jsxs)(d.Zp,{className:"mb-2 gap-4 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[t.isValid?(0,n.jsx)(eU.A,{className:"h-4 w-4 text-green-500"}):(0,n.jsx)(eI.A,{className:"h-4 w-4 text-red-500"}),(0,n.jsx)("span",{className:"font-medium",children:"Bitcoin Mining Validation"})]}),t.isValid?(0,n.jsx)(C.E,{variant:"default",children:"Valid Selection"}):(0,n.jsx)(C.E,{variant:"destructive",children:"Invalid Selection"})]}),(0,n.jsx)("div",{className:"text-muted-foreground text-sm",children:a}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsx)("span",{children:"Block Weight Usage:"}),(0,n.jsxs)("span",{className:(0,r.cn)("font-medium",i>100?"text-red-500":i>90?"text-orange-500":"text-green-600"),children:[i.toFixed(1),"%"]})]}),(0,n.jsx)(eO.k,{value:Math.min(i,100),className:(0,r.cn)("h-2",i>100&&"bg-red-100")}),(0,n.jsxs)("div",{className:"text-muted-foreground flex justify-between text-xs",children:[(0,n.jsxs)("span",{children:[t.totalWeight.toLocaleString()," / 4,000,000 weight units"]}),(0,n.jsx)("span",{children:t.remainingCapacity>0?"".concat(t.remainingCapacity.toLocaleString()," remaining"):"Limit exceeded"})]}),t.dependencyIssues>0&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs text-orange-600",children:[(0,n.jsx)(eI.A,{className:"h-3 w-3"}),(0,n.jsxs)("span",{children:[t.dependencyIssues," dependency issue(s)"]})]})]})]})}var eG=a(2657),eZ=a(2713),eX=a(4357),eY=a(1788);function eQ(e){let{data:t,isFetching:a,onToggle:i,showAutoSelectionControls:s=!1}=e,[c,m]=l.useState(!1),[x,h]=l.useState(!1),[g,p]=l.useState(!1),[f,b]=l.useState(!1),{declareJob:v,isLoading:j,currentTemplateId:y}=(0,eJ.Ou)(),{settings:C}=(0,em.t0)(),{canAddTransaction:T}=eq({transactions:t,selectedTransactions:[],enableRealTimeValidation:!0}),k=l.useRef(null),R=l.useMemo(()=>(function(e){let{canAddTransaction:t,onRowSelection:a,onSelectAll:l}=e;return[{id:"select",header:e=>{let{table:t}=e,a=t.getRowModel().rows,i=a.filter(e=>e.getIsSelected()),s=a.length>0&&i.length===a.length,o=i.length>0&&!s;return(0,n.jsx)(ez,{checked:s||o&&"indeterminate",onCheckedChange:e=>l(!!e),"aria-label":"Select all transactions"})},cell:e=>{let{row:l}=e,i=l.original,s=l.getIsSelected(),o=t(i);return(0,n.jsx)(eE,{transaction:i,isSelected:s,onSelectionChange:e=>a(i.txid,e),canSelect:o.canSelect,validationMessage:o.message})},meta:{label:"Checkbox",placeholder:"select transaction",variant:"text",icon:eD.A},size:32,enableHiding:!1},...eB.slice(1)]})({canAddTransaction:T,onRowSelection:(e,t)=>{try{var a;let n=null==(a=k.current)?void 0:a.getRow(e);n&&n.toggleSelected(t)}catch(t){console.warn("Transaction ".concat(e," not found in current table data"))}},onSelectAll:e=>{var t;null==(t=k.current)||t.toggleAllPageRowsSelected(e)}}),[T]),{table:A}=(0,eu.u)({data:t,columns:R,getRowId:e=>e.txid});l.useEffect(()=>{k.current=A},[A]);let z=A.getSelectedRowModel().rows,F=l.useMemo(()=>z.map(e=>e.original),[z]),I=l.useMemo(()=>F.map(e=>e.txid),[F]),{selectionSummary:E,validationState:D,cleanAndOptimizeSelection:M,removeInvalidTransactions:P}=eq({transactions:t,selectedTransactions:F,enableRealTimeValidation:!0});l.useEffect(()=>{if(F.length>0&&!D.isValid&&C.general.autoCleanInvalidTransactions){let e=M(F);e.removedTransactions.length>0&&(A.toggleAllRowsSelected(!1),setTimeout(()=>{e.optimizedTransactions.forEach(e=>{try{let t=A.getRow(e.txid);t&&t.toggleSelected(!0)}catch(t){console.warn("Transaction ".concat(e.txid," not found in current table data"))}})},100),o.oR.warning("Invalid transactions removed",{description:"Removed ".concat(e.removedTransactions.length," invalid transaction(s). ").concat(e.summary),action:{label:"Undo",onClick:()=>{A.toggleAllRowsSelected(!1),setTimeout(()=>{F.forEach(e=>{try{let t=A.getRow(e.txid);t&&t.toggleSelected(!0)}catch(t){console.warn("Transaction ".concat(e.txid," not found"))}})},100)}}}))}},[D.isValid,F.length,M,A,C.general.autoCleanInvalidTransactions]);let B=l.useCallback(()=>{if(0===F.length)return void o.oR.info("No transactions selected to clean");let e=M(F);if(0===e.removedTransactions.length)return void o.oR.success("All selected transactions are valid");A.toggleAllRowsSelected(!1),setTimeout(()=>{e.optimizedTransactions.forEach(e=>{try{let t=A.getRow(e.txid);t&&t.toggleSelected(!0)}catch(t){console.warn("Transaction ".concat(e.txid," not found in current table data"))}})},100),o.oR.success("Selection cleaned",{description:"Removed ".concat(e.removedTransactions.length," invalid transaction(s). ").concat(e.summary)})},[F,M,A]),_=l.useCallback(e=>{if(0===e.length)return void A.toggleAllRowsSelected(!1);e.forEach(e=>{try{let t=A.getRow(e);t&&t.toggleSelected(!0)}catch(t){console.warn("Transaction ".concat(e," not found in current table data"))}})},[A]),{handleManualAutoSelection:L}=function(e){let{transactions:t,onSelectTransactions:a,selectedTxids:n,currentTemplateId:i,isFetching:s,onToggleFetching:r,onDeclareJob:c}=e,{settings:d}=(0,em.t0)(),u=(0,l.useRef)(null),m=(0,l.useRef)(!1),x=(0,l.useRef)(null),h=(0,l.useCallback)(async()=>{if(d.autoSelection.onNewTemplate.enabled&&(!d.autoSelection.onNewTemplate.requireTemplate||i)&&(!d.autoSelection.onNewTemplate.requireTemplate||u.current!==i)&&!m.current){d.autoSelection.onNewTemplate.requireTemplate&&(u.current=i),m.current=!0;try{await eh(d.autoSelection.onNewTemplate,t,n,i,d,{onSelectTransactions:a,onToggleFetching:r,onDeclareJob:c},s)}finally{m.current=!1}}},[d,i,t,a,s,r,c,n]);(0,l.useEffect)(()=>{d.autoSelection.onNewTemplate.enabled&&(!d.autoSelection.onNewTemplate.requireTemplate||i&&u.current!==i)&&h()},[i,d.autoSelection.onNewTemplate.enabled,d.autoSelection.onNewTemplate.requireTemplate]),(0,l.useEffect)(()=>(x.current&&(clearInterval(x.current),x.current=null),d.autoSelection.onNewTemplate.enabled&&d.autoSelection.onNewTemplate.periodicEnabled&&(!d.autoSelection.onNewTemplate.requireTemplate||i)&&(x.current=setInterval(()=>{if(m.current||d.autoSelection.onNewTemplate.requireTemplate&&!i)return;let e=u.current;u.current=null,h().finally(()=>{d.autoSelection.onNewTemplate.requireTemplate&&(u.current=e)})},1e3*(d.autoSelection.onNewTemplate.periodicInterval||30))),()=>{x.current&&(clearInterval(x.current),x.current=null)}),[d.autoSelection.onNewTemplate.enabled,d.autoSelection.onNewTemplate.periodicEnabled,d.autoSelection.onNewTemplate.periodicInterval,d.autoSelection.onNewTemplate.requireTemplate,i,h]);let g=(0,l.useCallback)(async()=>{if(!d.autoSelection.onNewTemplate.enabled)return void o.oR.error("Auto-selection disabled",{description:"Please enable auto-selection in settings first",duration:3e3});if(d.autoSelection.onNewTemplate.requireTemplate&&!i)return void o.oR.error("No template available",{description:'Template is required for auto-selection. Wait for a new template to arrive or disable "Require Template" setting',duration:3e3});if(m.current)return void o.oR.warning("Auto-selection in progress",{description:"Please wait for the current auto-selection to complete",duration:3e3});let e=u.current;u.current=null;try{await h()}finally{d.autoSelection.onNewTemplate.requireTemplate&&(u.current=e)}},[d.autoSelection.onNewTemplate.enabled,d.autoSelection.onNewTemplate.requireTemplate,i,h]);return{getMatchingSummary:(0,l.useCallback)(()=>({onNewTemplate:ex.getMatchingSummary(t,d.autoSelection.onNewTemplate)}),[t,d.autoSelection]),triggerAutoSelection:h,handleManualAutoSelection:g}}({transactions:t,onSelectTransactions:_,selectedTxids:I,currentTemplateId:y,isFetching:a,onToggleFetching:i,onDeclareJob:v}),O=e=>{e?(m(!0),a&&i()):(m(!1),a||i())},W=async()=>{p(!0);try{await (0,r.vD)(F)}catch(e){o.oR.error("Export failed: There was an error exporting the selected transactions: ")}finally{p(!1)}},J=async()=>{b(!0);try{await (0,r.qJ)(F)}catch(e){o.oR.error("Copy failed: There was an error copying the selected transaction IDs.")}finally{b(!1)}},V=async()=>{if(!D.isValid)return void o.oR.error("Cannot declare job",{description:"Selected transactions violate Bitcoin mining criteria. Please fix validation issues first."});let e=F.map(e=>e.txid);await v(e)&&A.toggleAllRowsSelected(!1)},K=(0,n.jsxs)(er,{table:A,className:"rounded-xl p-4",children:[(0,n.jsx)(ed,{table:A}),(0,n.jsxs)(ec,{tooltip:D.isValid?y?"Declare job with selected transactions (Template ID: ".concat(y,")"):"Wait for template notification to declare job":"Fix validation issues before declaring job",onClick:V,isPending:j,disabled:!D.isValid||!y,children:[(0,n.jsx)(ev.A,{}),"Declare Job"]}),(0,n.jsxs)(ec,{tooltip:"View selected transactions",onClick:()=>O(!0),children:[(0,n.jsx)(eG.A,{}),"View Selected"]}),(0,n.jsxs)(ec,{tooltip:"Show summary of selected transactions",onClick:()=>h(!0),children:[(0,n.jsx)(eZ.A,{}),"Summary"]}),(0,n.jsxs)(ec,{tooltip:"Copy transaction IDs to clipboard",onClick:J,isPending:f,children:[(0,n.jsx)(eX.A,{}),"Copy IDs"]}),(0,n.jsxs)(ec,{tooltip:"Export selected transactions to CSV",onClick:W,isPending:g,children:[(0,n.jsx)(eY.A,{}),"Export"]}),(0,n.jsxs)(ec,{tooltip:"Remove invalid transactions from selection",onClick:B,disabled:0===F.length,children:[(0,n.jsx)(N.A,{}),"Remove Invalid"]})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e$,{validationState:D,selectionSummary:E,selectedCount:F.length}),(0,n.jsx)(d.Zp,{children:(0,n.jsx)("div",{className:"px-4",children:(0,n.jsxs)(w,{table:A,actionBar:K,children:[s&&(0,n.jsx)(ek,{transactions:t,currentTemplateId:y,onSelectTransactions:_,selectedTxids:I,isFetching:a,onToggleFetching:i,onManualAutoSelection:L}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(S.w,{table:A}),(0,n.jsx)(u.$,{variant:a?"destructive":"default",size:"sm",onClick:i,children:a?"Pause":"Resume"}),(0,n.jsx)(et,{table:A})]})]})})}),(0,n.jsx)(eW,{isOpen:x,selectedData:F,handleModal:h}),(0,n.jsx)(eH,{isOpen:c,selectedData:F,parentTable:A,handleModal:O,allTransactions:t})]})}function e0(){let{transactions:e,isFetching:t,toggle:a}=function(){let[e,t]=l.useState([]),[a,n]=l.useState([]),[c,d]=l.useState(!0),u=l.useRef(c),m=l.useRef(null);return l.useEffect(()=>{i.A.get("http://localhost:3001/api/mempool").then(e=>{t(e.data.map(e=>({...(0,r.FS)(e),feeRate:1e8*e.fees.base/e.vsize})))}).catch(()=>{})},[]),l.useEffect(()=>{u.current=c},[c]),l.useEffect(()=>{let e=new s.A("ws://localhost:3001/ws/bitcoin/stream");return m.current=e,e.onmessage=e=>{let a=JSON.parse(e.data);switch(a.event){case"A":let l={...(0,r.FS)(a.transaction),feeRate:1e8*a.transaction.fees.base/a.transaction.vsize};u.current?t(e=>[l,...e.filter(e=>e.txid!==l.txid)]):n(e=>[l,...e.filter(e=>e.txid!==l.txid)]);break;case"R":t(e=>e.filter(e=>e.txid!==a.txid)),n(e=>e.filter(e=>e.txid!==a.txid));break;case"C":let i=a.block.block_hash.slice(0,10)+"...",s=a.block.height,c=a.block.txids.length-1;o.oR.success("Block #".concat(s," Mined"),{description:"".concat(c," transactions confirmed in block ").concat(i),action:{label:"View Block",onClick:()=>window.open("https://mempool.space/block/".concat(a.block.block_hash),"_blank")}});let d=new Set(a.block.txids);t(e=>e.filter(e=>!d.has(e.txid))),n(e=>e.filter(e=>!d.has(e.txid)));break;case"D":let m=a.block_hash.slice(0,8)+"...";o.oR.warning("\uD83D\uDD04 Chain Reorganization",{description:"Block ".concat(m," disconnected, ").concat(a.transactions.length," txs back to mempool"),action:{label:"View Block",onClick:()=>window.open("https://mempool.space/block/".concat(a.block_hash),"_blank")}});let x=a.transactions.map(e=>({...(0,r.FS)(e),feeRate:1e8*e.fees.base/e.vsize})),h=e=>{let t=new Set(e.map(e=>e.txid));return[...e,...x.filter(e=>!t.has(e.txid))]};u.current?t(h):n(h)}},()=>{e.close(),m.current=null}},[]),l.useEffect(()=>{c&&a.length>0&&(t(e=>{let t=new Set(e.map(e=>e.txid));return[...e,...a.filter(e=>!t.has(e.txid))]}),n([]))},[c,a]),{transactions:e,isFetching:c,toggle:()=>d(e=>!e)}}(),[d]=(0,c.ZA)("txid",c.tU.withDefault("")),u=l.useMemo(()=>e.filter(e=>!d||e.txid.toLowerCase().includes(d.toLowerCase())),[e,d]);return(0,n.jsx)("div",{className:"data-table-container",children:(0,n.jsx)(eQ,{data:u,isFetching:t,onToggle:a,showAutoSelectionControls:!0})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[105,277,671,184,148,904,334,613,320,541,890,982,871,441,684,358],()=>t(6550)),_N_E=e.O()}]);